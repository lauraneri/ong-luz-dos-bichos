<script>
  // Prevent forms from submitting.
  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
    for (var i = 0; i < forms.length; i++) {
      forms[i].addEventListener('submit', function(event) {
        event.preventDefault();
      });
    }
  }
  window.addEventListener('load', preventFormSubmit);

  function handleFormSubmit() {
    const userInfo = {}

    const nomeInput = document.getElementById('nomeInput')
    const idadeInput = document.getElementById('idadeInput')
    const telefoneInput = document.getElementById('telefoneInput')
    const disponibilidadeInput = document.getElementById('disponibilidadeInput')

    userInfo.Nome = nomeInput.value
    userInfo.Idade = idadeInput.value
    userInfo.Telefone = telefoneInput.value
    userInfo.Disponibilidade = disponibilidadeInput.value

    const res = google.script.run
      .withSuccessHandler(response => {
        nomeInput.value = null
        idadeInput.value = null
        telefoneInput.value = null
        disponibilidadeInput.value = null
        M.toast({html: response, classes: 'rounded'});
    })
      .pessoalRegistrarOuAtualizarCadastro(userInfo)

  }

  function handleFormFetchUserInfo() {
    const res = google.script.run
      .withSuccessHandler(data => {
        document.getElementById('nomeInput').value = data['Nome']
        document.getElementById('idadeInput').value = data['Idade']
        document.getElementById('telefoneInput').value = data['Telefone']
        document.getElementById('disponibilidadeInput').value = data['Disponibilidade']

        M.updateTextFields();
        M.toast({html: 'Dados consultados com sucesso!', classes: 'rounded'});
    })
      .pessoalObterCadastro()
  }

</script>