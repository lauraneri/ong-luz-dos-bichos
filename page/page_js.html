<script>
  // Prevent forms from submitting.
  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
    for (var i = 0; i < forms.length; i++) {
      forms[i].addEventListener('submit', function(event) {
        event.preventDefault();
      });
    }
  }
  window.addEventListener('load', preventFormSubmit);

  function handleFormSubmit() {
    const userInfo = {}

    userInfo.Nome = document.getElementById('nomeInput').value
    userInfo.Idade = document.getElementById('idadeInput').value
    userInfo.Telefone = document.getElementById('telefoneInput').value
    userInfo.Disponibilidade = document.getElementById('disponibilidadeInput').value

    const res = google.script.run
      .withSuccessHandler(response => {
        alert(response)
    })
      .pessoalRegistrarOuAtualizarCadastro(userInfo)

  }

  function handleFormFetchUserInfo() {
    const res = google.script.run
      .withSuccessHandler(data => {
        document.getElementById('nomeInput').textContent = data['Nome']
        document.getElementById('idadeInput').textContent = data['Idade']
        document.getElementById('telefoneInput').textContent = data['Telefone']
        document.getElementById('disponibilidadeInput').textContent = data['Disponibilidade']
        alert('Dados obtidos com sucesso!')
    })
      .pessoalObterCadastro()
  }

</script>