<script>
  // Prevent forms from submitting.
  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
    for (var i = 0; i < forms.length; i++) {
      forms[i].addEventListener('submit', function(event) {
        event.preventDefault();
      });
    }
  }
  window.addEventListener('load', preventFormSubmit);

  function handleFormSubmit() {
    const userInfo = {}

    const nomeInput = document.getElementById('nomeInput')
    const idadeInput = document.getElementById('idadeInput')
    const telefoneInput = document.getElementById('telefoneInput')
    const disponibilidadeInput = document.getElementById('disponibilidadeInput')

    userInfo.NOME = nomeInput.value
    userInfo.IDADE = idadeInput.value
    userInfo.TELEFONE = telefoneInput.value
    userInfo.DISPONIBILIDADE = disponibilidadeInput.value

    const res = google.script.run
      .withSuccessHandler(response => {
        nomeInput.value = null
        idadeInput.value = null
        telefoneInput.value = null
        disponibilidadeInput.value = null
        M.toast({html: response, classes: 'rounded'});
    }).withFailureHandler(response => {
      M.toast({html: response, classes: 'rounded'});
    })
      .pessoalRegistrarOuAtualizarCadastro(userInfo)

  }

  function handleFormFetchUserInfo() {
    const res = google.script.run
      .withSuccessHandler(data => {
        document.getElementById('nomeInput').value = data['NOME']
        document.getElementById('idadeInput').value = data['IDADE']
        document.getElementById('telefoneInput').value = data['TELEFONE']
        document.getElementById('disponibilidadeInput').value = data['DISPONIBILIDADE']

        M.updateTextFields();
        M.toast({html: `Dados consultados com sucesso para o email ${data['EMAIL']}`, classes: 'rounded'});
    }).withFailureHandler(data => {
      M.toast({html: data, classes: 'rounded'});
    })
      .pessoalObterCadastro()
  }

</script>